# Copyright FUJITSU LIMITED 2016
swagger: '2.0'
info:
  title: Account Service REST API
  description: API account related resources
  version: "1.0.0"

# the domain of the service
host: host_port
# array of schemes that the API supports
schemes:
  - https
# will be prefixed to all paths
basePath: /oscm-account/v1
consumes:
  - application/json
produces:
  - application/json

securityDefinitions:
  authentication:
    type: basic
    description: HTTP basic authentication with a user ID and password

security:
  - authentication: []

paths:
  /organizations:
    post:
      summary: Account Definition
      description: Create an organization account
      parameters:
        - name: account
          in: body
          description: The organization account to create
          required: true
          schema:
            $ref: '#/definitions/Account'

      responses:
        201:
          description: Created
          headers:
            location:
              description: The ID of the new organization
              type: string
  /organizations/{id}:
    get:
      responses:
        200:
          description: An organization
          schema:
            $ref: '#/definitions/Organization'
  /billingcontacts
  get: - description: Get existing billing contacts for the calling users organization.
           responses:
             200:
               description: A collection of billing contacts
               schema:
                 $ref: '#/definitions/CollectionBillingContact'
  post:
    description: Create a billing contact in the calling users organization.
    parameters:
      - name: billing contact
        in: body
        description: The billing contact to create
        required: true
        schema:
          $ref: '#/definitions/BillingContact'
    responses:
      201:
        description: Created
        headers:
          location:
            description: The ID of the new billing contact
            type: integer
  /billingcontacts/{id}
  get:
    description: Get the specified billing contact.
    responses:
      200:
        description: A billing contact
        schema:
          $ref: '#/definitions/BillingContact'
  put:
    description: Updates the billing contact with the specified id.
    parameters:
      - name: id
        in: path
        description: The ID of the billing contact
        required: true
        type: number
        format: long
      - name: billing contact
        in: body
        description: The billing contact with the new values
        required: true
        schema:
          $ref: '#/definitions/BillingContact'
      - name: If-Match
        in: header
        description: The ETag of the billing contact for concurrency checks. If not present or '*',  concurrency is ignored.
        required: false
        type: string
    responses:
      204:
        description: No content
  delete: - delete the billing contact with the specified id (key)
            description: Deletes the billing contact with the specified id.
            parameters:
              - name: id
                in: path
                description: The ID of the billing contact
                required: true
                type: number
                format: long
            responses:
              204:
                description: No content
  /paymentinfos
  get:
    description: Get the existing payment infos for the calling users organization.
    responses:
      200:
        description: A collection of payment infos
        schema:
          $ref: '#/definitions/CollectionPaymentInfo'
  /paymentinfos/{id}
  get:
    description: Get the specified payment info.
    responses:
      200:
        description: A payment info
        schema:
          $ref: '#/definitions/PaymentInfo'
  put: - update the payment info with the specified id (key)
         description: Updates the payment info with the specified id.
         parameters:
           - name: id
             in: path
             description: The ID of the payment info
             required: true
             type: number
             format: long
           - name: payment info
             in: body
             description: The payment info with the new values
             required: true
             schema:
               $ref: '#/definitions/PaymentInfo'
           - name: If-Match
             in: header
             description: The ETag of the payment info for concurrency checks. If not present or '*',  concurrency is ignored.
             required: false
             type: string
         responses:
           204:
             description: No content
  delete:
    description: Deletes the payment info with the specified id.
    parameters:
      - name: id
        in: path
        description: The ID of the payment info
        required: true
        type: number
        format: long
    responses:
      204:
        description: No content

definitions:
  Account:
    type: object
    properties:
      organization:
        type: object
        $ref: '#/definitions/Organization'
      user:
        type: object
        $ref: '#/definitions/User'
      password:
        type: string
        format: password
      serviceKey:
        type: integer
        format: int64
      sellerId:
        type: string
      ldapProperties:
        type: object
        additionalProperties:
          type: string
      organizationRoles:
        type: array
        items:
          type: string
          enum:
            - MARKETPLACE_OWNER
            - PLATFORM_OPERATOR
            - TECHNOLOGY_PROVIDER
            - SUPPLIER
            - CUSTOMER
            - BROKER
            - RESELLER

  Organization:
    type: object
    properties:
      id:
        type: integer
        format: int64
      etag:
        type: integer
        format: int64
      organizationId:
        type: string
      address:
        type: string
      email:
        type: string
        format: email
      locale:
        type: string
      name:
        type: string
      phone:
        type: string
      url:
        type: string
        format: url
      description:
        type: string
      domicileCountry:
        type: string
      supportEmail:
        type: string
        format: email

  PaymentInfo:
    type: object
    properties:
      id:
        type: integer
        format: int64
      etag:
        type: integer
        format: int64
      infoId:
        type: string
      providerName:
        type: string
      accountNumber:
        type: string
      paymentType:
        type: object
        $ref: '#/definitions/PaymentType'

  PaymentType:
    type: object
    properties:
      id:
        type: integer
        format: int64
      etag:
        type: integer
        format: int64
      name:
        type: string
      paymentTypeId:
        type: string
      collectionType:
        type: string
        enum:
          - ORGANIZATION
          - PAYMENT_SERVICE_PROVIDER

  BillingContact:
    type: object
    description: Trigger process
    properties:
      id:
        type: integer
        format: int64
      etag:
        type: integer
        format: int64
      email:
        type: string
      companyName:
        type: string
      address:
        type: string
      orgAddressUsed:
        type: boolean
      contactId:
        type: string

  User:
    type: object
    properties:
      id:
        type: integer
        format: int64
      etag:
        type: integer
        format: int64
      email:
        type: string
      firstName:
        type: string
      additionalName:
        type: string
      lastName:
        type: string
      address:
        type: string
      phone:
        type: string
      locale:
        type: string
      salutation:
        type: string
        enum:
          - MR
          - MS
      realmUserId:
        type: string
      organizationId:
        type: string
      userId:
        type: string

  CollectionBillingContact:
    type: object
    description: Collection of billing contacts
    properties:
      items:
        type: array
        items:
          $ref: '#/definitions/BillingContact'

  CollectionPaymentInfo:
    type: object
    description: Collection of payment infos
    properties:
      items:
        type: array
        items:
          $ref: '#/definitions/PaymentInfo'

  Error:
    type: object
    properties:
      code:
        type: integer
        format: int32
      message:
        type: string
      property:
        type: string
      moreInfo:
        type: string
  